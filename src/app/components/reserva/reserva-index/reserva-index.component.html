<ngx-loading [show]="loading" [config]="{
    backdropBorderRadius: '8px',
    primaryColour: '#0d6efd',
    secondaryColour: '#6c757d',
    tertiaryColour: '#0d6efd'
  }">
</ngx-loading>
<div class="container-fluid my-4">
  <div class="row">

    <!-- Columna izquierda: Formulario -->
    <div class="col-md-6">
      <form [formGroup]="form" class="p-4 shadow rounded bg-white">

        <h4 class="mb-4 text-primary">Reserva de Ruta</h4>

        <div class="row">
          <!-- Origen -->
          <div class="mb-3 col-6">
            <label class="form-label fw-bold">Origen</label>
            <ng-select [items]="rutas" bindValue="origen" bindLabel="origen" formControlName="origen_id"
              [searchable]="true" [clearable]="true" placeholder="Seleccione un origen" class="custom-select">
            </ng-select>
          </div>

          <!-- Destino -->
          <div class="mb-3 col-6">
            <label class="form-label fw-bold">Destino</label>
            <ng-select [items]="rutas" bindValue="destino" bindLabel="destino" formControlName="destino_id"
              [searchable]="true" [clearable]="true" placeholder="Seleccione un destino" class="custom-select">
            </ng-select>
          </div>

        </div>

        <button class="btn btn-primary w-100 mt-3" (click)="buscarRuta()" [disabled]="form.invalid">
          Buscar Rutas
        </button>
      </form>
    </div>

    <!-- Columna derecha: Información -->
    <div class="col-md-6">
      <div class="p-4 shadow rounded bg-light">
        <h5 class="text-secondary">Información seleccionada</h5>
        <p *ngIf="!form.value.origen_id">No ha seleccionado origen</p>
        <p *ngIf="!form.value.destino_id">No ha seleccionado destino</p>

        <div *ngIf="form.value.origen_id && form.value.destino_id">
          <p><b>Origen:</b> {{ form.value.origen_id }}</p>
          <p><b>Destino:</b> {{ form.value.destino_id }}</p>
        </div>
      </div>
    </div>

  </div>

  <div class="row">
    <div class="col-md-12 rounded p-4 g-3">
      <div class="row g-4" *ngIf="horarios && horarios.length > 0; else noResults">
        <h3>Resultados</h3>
        <div class="col-md-3" *ngFor="let item of horarios">
          <div class="card h-100 shadow-sm border-0">
            <div class="card-body d-flex flex-column align-items-center justify-content-center">
              <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center mb-3"
                style="width:60px; height:60px;">
                <i class="fa-solid fa-bus text-white fs-2"></i>
              </div>
              <h5 class="card-title text-center mb-2">Ruta disponible</h5>
              <p class="card-text text-center text-muted">
                {{item.id}}
              </p>
              <p class="card-text text-center text-muted">
                {{ item.horaSalida }} | {{ item.fechaSalida }}
              </p>

              <button class="btn btn-outline-primary mt-2 w-100" (click)="reservar(item.id)">Reservar</button>
            </div>
          </div>
        </div>
      </div>
      <ng-template #noResults>
        <p class="text-muted"> No se encontraron rutas disponibles. </p>
      </ng-template>
    </div>
  </div>
</div>
